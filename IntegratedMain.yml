---
    - name: Provision an  Instance
      hosts: localhost
      connection: local
      gather_facts: False
      vars:
         provider : "{{ provider }}"


      
   


      roles:

  
        - { role: azure-vm , when:  (provider == 'azure') }
        - { role: aws-ec2 , when: (provider == 'aws')}
        - { role: gce-vm , when: provider == "gce"}
        - { role: vcenter-vm , when: provider == "vc" }

      # tasks:
    

      #   - import_role:
      #       name: aws-ec2
      #     when: provider == 'aws'
      #     tags: aws

      #   - import_role:
      #       name: azure-vm
      #     when: provider == 'azure'
      #     tags: azure

      #   - import_role:
      #       name: vcenter-vm
      #     when: provider == 'vc'
      #     tags: vcenter

      #   - import_role:
      #       name: gce-vm
      #     when: provider == 'gce'
      #     tags: gce